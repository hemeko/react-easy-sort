!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("array-move"),require("react")):"function"==typeof define&&define.amd?define(["exports","tslib","array-move","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactEasySort={},e.tslib,e.arrayMove,e.React)}(this,(function(e,t,n,r){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=u(n),c=u(r),a=function(e,t,n){for(var r=e.x,u=e.y,o=(void 0===n?{}:n).fallbackToClosest,c=void 0!==o&&o,a=1e4,i=-1,l=0;l<t.length;l+=1){var d=t[l];if(r>=d.left&&r<d.right&&u>=d.top&&u<d.bottom)return l;if(c){var f=(d.left+d.right)/2,s=(d.top+d.bottom)/2,v=Math.sqrt(Math.pow(r-f,2)+Math.pow(u-s,2));v<a&&(a=v,i=l)}}return i},i=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},l=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},d=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},f=function(e){e.preventDefault()},s=function(){window.removeEventListener("contextmenu",f)},v=function(e){var t=e.onStart,n=e.onMove,r=e.onEnd,u=e.allowDrag,o=void 0===u||u,a=e.containerRef,v=e.knobs,m=c.default.useRef({x:0,y:0}),p=c.default.useRef(void 0),b=c.default.useRef(null),h=c.default.useRef({onStart:t,onMove:n,onEnd:r}),y=c.default.useState(!1),E=y[0],g=y[1];c.default.useEffect((function(){h.current={onStart:t,onMove:n,onEnd:r}}),[t,n,r]);var x=function(){p.current&&window.clearTimeout(p.current)},w=c.default.useCallback((function(){if(a.current){var e=a.current.getBoundingClientRect();m.current={x:e.left,y:e.top}}}),[a]),C=c.default.useCallback((function(e){var t=d(e,m.current);h.current.onMove&&h.current.onMove({pointInWindow:e,point:t})}),[]),L=c.default.useCallback((function(e){C(i(e))}),[C]),k=c.default.useCallback((function(e){var t=i(e),n=d(t,m.current);h.current.onStart&&h.current.onStart({point:n,pointInWindow:t})}),[]),R=c.default.useCallback((function(e){e.cancelable?(e.preventDefault(),C(l(e.touches[0]))):(document.removeEventListener("touchmove",R),h.current.onEnd&&h.current.onEnd())}),[C]),S=c.default.useCallback((function(){b.current&&clearTimeout(b.current),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",S),h.current.onEnd&&h.current.onEnd()}),[L]),I=c.default.useCallback((function(){document.removeEventListener("touchmove",R),document.removeEventListener("touchend",I),s(),h.current.onEnd&&h.current.onEnd()}),[R]),M=c.default.useCallback((function(e){if(0===e.button&&(!(null==v?void 0:v.length)||v.find((function(t){return t.contains(e.target)})))){document.addEventListener("mousemove",L),document.addEventListener("mouseup",S),w();var t=e.clientX,n=e.clientY;b.current=window.setTimeout((function(){k({clientX:t,clientY:n})}),300)}}),[L,S,w,v]),_=c.default.useCallback((function(e,t){document.addEventListener("touchmove",R,{capture:!1,passive:!1}),document.addEventListener("touchend",I),window.addEventListener("contextmenu",f,{capture:!0,passive:!1}),h.current.onStart&&h.current.onStart({point:e,pointInWindow:t})}),[I,R]),D=c.default.useCallback((function(e){if(!(null==v?void 0:v.length)||v.find((function(t){return t.contains(e.target)}))){w();var t=l(e.touches[0]),n=d(t,m.current);p.current=window.setTimeout((function(){return _(n,t)}),120)}}),[_,w,v]),T=c.default.useCallback((function(){g(!0),document.removeEventListener("touchstart",T)}),[]),N=c.default.useCallback((function(){x()}),[]);return c.default.useLayoutEffect((function(){if(E){var e=a.current;return o&&(null==e||e.addEventListener("touchstart",D,{capture:!0,passive:!1}),document.addEventListener("touchmove",N,{capture:!1,passive:!1}),document.addEventListener("touchend",N,{capture:!1,passive:!1})),function(){null==e||e.removeEventListener("touchstart",D,{capture:!0}),document.removeEventListener("touchmove",N,{capture:!1}),document.removeEventListener("touchend",N,{capture:!1}),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",I),s(),x()}}return document.addEventListener("touchstart",T),function(){document.removeEventListener("touchstart",T),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",S)}}),[E,o,T,L,R,N,I,S,a,D]),E?{}:{onMouseDown:M}},m=c.default.createContext(void 0);e.SortableItem=function(e){var t=e.children,n=c.default.useContext(m);if(!n)throw new Error("SortableItem must be a child of SortableList");var r=n.registerItem,u=n.removeItem,o=c.default.useRef(null);return c.default.useEffect((function(){var e=o.current;return e&&r(e),function(){e&&u(e)}}),[r,u,t]),c.default.cloneElement(t,{ref:o})},e.SortableKnob=function(e){var t=e.children,n=c.default.useContext(m);if(!n)throw new Error("SortableKnob must be a child of SortableList");var r=n.registerKnob,u=n.removeKnob,o=c.default.useRef(null);return c.default.useEffect((function(){var e=o.current;return e&&r(e),function(){e&&u(e)}}),[r,u,t]),c.default.cloneElement(t,{ref:o})},e.default=function(e){var n=e.children,r=e.allowDrag,u=void 0===r||r,i=e.onSortEnd,l=e.draggedItemClassName,d=e.as,f=e.lockAxis,s=e.customHolderRef,p=t.__rest(e,["children","allowDrag","onSortEnd","draggedItemClassName","as","lockAxis","customHolderRef"]),b=c.default.useRef([]),h=c.default.useRef([]),y=c.default.useRef([]),E=c.default.useRef(null),g=c.default.useRef(null),x=c.default.useRef(void 0),w=c.default.useRef(void 0),C=c.default.useRef({x:0,y:0});c.default.useEffect((function(){var e=(null==s?void 0:s.current)||document.body;return function(){g.current&&e.removeChild(g.current)}}),[s]);var L=function(e){if(g.current&&void 0!==x.current){var t=C.current,n=h.current[x.current],r="y"===f?n.left:e.x-t.x,u="x"===f?n.top:e.y-t.y;g.current.style.transform="translate3d(".concat(r,"px, ").concat(u,"px, 0px)")}},k=c.default.useCallback((function(e){if(E.current){var t=b.current[e],n=h.current[e],r=t.cloneNode(!0);l&&l.split(" ").forEach((function(e){return r.classList.add(e)})),r.style.width="".concat(n.width,"px"),r.style.height="".concat(n.height,"px"),r.style.position="fixed",r.style.margin="0",r.style.top="0",r.style.left="0";var u=t.querySelectorAll("canvas");r.querySelectorAll("canvas").forEach((function(e,t){var n;null===(n=e.getContext("2d"))||void 0===n||n.drawImage(u[t],0,0)})),((null==s?void 0:s.current)||document.body).appendChild(r),g.current=r}}),[s,l]),R=v({allowDrag:u,containerRef:E,knobs:y.current,onStart:function(e){var t=e.pointInWindow;if(E.current){h.current=b.current.map((function(e){return e.getBoundingClientRect()}));var n=a(t,h.current);if(-1!==n){x.current=n,k(n);var r=b.current[n];r.style.opacity="0",r.style.visibility="hidden";var u=r.getBoundingClientRect();C.current={x:t.x-u.left,y:t.y-u.top},L(t),window.navigator.vibrate&&window.navigator.vibrate(100)}}},onMove:function(e){var t=e.pointInWindow;L(t);var n=x.current;if(void 0!==n&&void 0!==x.current){var r=h.current[x.current],u={x:"y"===f?r.left:t.x,y:"x"===f?r.top:t.y},o=a(u,h.current,{fallbackToClosest:!0});if(-1!==o){w.current=o;for(var c=n<o,i=0;i<b.current.length;i+=1){var l=b.current[i],d=h.current[i];if(c&&i>=n&&i<=o||!c&&i>=o&&i<=n){var s=h.current[c?i-1:i+1];if(s){var v=s.left-d.left,m=s.top-d.top;l.style.transform="translate3d(".concat(v,"px, ").concat(m,"px, 0px)")}}else l.style.transform="translate3d(0,0,0)";l.style.transitionDuration="300ms"}}}},onEnd:function(){for(var e=0;e<b.current.length;e+=1){var t=b.current[e];t.style.transform="",t.style.transitionDuration=""}var n=x.current;if(void 0!==n){var r=b.current[n];r&&(r.style.opacity="1",r.style.visibility="");var u=w.current;void 0!==u&&n!==u&&(b.current=o.default(b.current,n,u),i(n,u))}(x.current=void 0,w.current=void 0,g.current)&&(((null==s?void 0:s.current)||document.body).removeChild(g.current),g.current=null)}}),S=c.default.useCallback((function(e){b.current.push(e)}),[]),I=c.default.useCallback((function(e){var t=b.current.indexOf(e);-1!==t&&b.current.splice(t,1)}),[]),M=c.default.useCallback((function(e){y.current.push(e)}),[]),_=c.default.useCallback((function(e){var t=y.current.indexOf(e);-1!==t&&y.current.splice(t,1)}),[]),D=c.default.useMemo((function(){return{registerItem:S,removeItem:I,registerKnob:M,removeKnob:_}}),[S,I,M,_]);return c.default.createElement(d||"div",t.__assign(t.__assign(t.__assign({},u?R:{}),p),{ref:E}),c.default.createElement(m.Provider,{value:D},n))},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=react-easy-sort.min.js.map
