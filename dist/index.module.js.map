{"version":3,"file":"index.module.js","sources":["../src/helpers.ts","../src/hooks.ts","../src/index.tsx"],"sourcesContent":["import { Point } from './types'\n\n/**\n * This function check if a given point is inside of the items rect.\n * If it's not inside any rect, it will return the index of the closest rect\n */\nexport const findItemIndexAtPosition = (\n  { x, y }: Point,\n  itemsRect: DOMRect[],\n  { fallbackToClosest = false } = {}\n): number => {\n  let smallestDistance = 10000\n  let smallestDistanceIndex = -1\n  for (let index = 0; index < itemsRect.length; index += 1) {\n    const rect = itemsRect[index]\n    // if it's inside the rect, we return the current index directly\n    if (x >= rect.left && x < rect.right && y >= rect.top && y < rect.bottom) {\n      return index\n    }\n    if (fallbackToClosest) {\n      // otherwise we compute the distance and update the smallest distance index if needed\n      const itemCenterX = (rect.left + rect.right) / 2\n      const itemCenterY = (rect.top + rect.bottom) / 2\n\n      const distance = Math.sqrt(Math.pow(x - itemCenterX, 2) + Math.pow(y - itemCenterY, 2)) // ** 2 operator is not supported on IE11\n      if (distance < smallestDistance) {\n        smallestDistance = distance\n        smallestDistanceIndex = index\n      }\n    }\n  }\n  return smallestDistanceIndex\n}\n","import React from 'react'\n\nimport { Point, PseudoMouseEvent } from './types'\n\n\nconst getMousePoint = (e: PseudoMouseEvent): Point => ({\n  x: Number(e.clientX),\n  y: Number(e.clientY),\n})\n\nconst getTouchPoint = (touch: Touch | React.Touch): Point => ({\n  x: Number(touch.clientX),\n  y: Number(touch.clientY),\n})\n\nconst getPointInContainer = (point: Point, containerTopLeft: Point): Point => {\n  return {\n    x: point.x - containerTopLeft.x,\n    y: point.y - containerTopLeft.y,\n  }\n}\n\nconst preventDefault = (event: Event) => {\n  event.preventDefault()\n}\n\nconst disableContextMenu = () => {\n  window.addEventListener('contextmenu', preventDefault, { capture: true, passive: false })\n}\n\nconst enableContextMenu = () => {\n  window.removeEventListener('contextmenu', preventDefault)\n}\n\nexport type OnStartArgs = { point: Point; pointInWindow: Point }\nexport type OnMoveArgs = { point: Point; pointInWindow: Point }\n\ntype UseDragProps = {\n  onStart?: (args: OnStartArgs) => void\n  onMove?: (args: OnMoveArgs) => void\n  onEnd?: () => void\n  allowDrag?: boolean\n  containerRef: React.MutableRefObject<HTMLElement | null>\n  knobs?: HTMLElement[]\n}\n\nexport const useDrag = ({\n  onStart,\n  onMove,\n  onEnd,\n  allowDrag = true,\n  containerRef,\n  knobs,\n}: UseDragProps) => {\n  // contains the top-left coordinates of the container in the window. Set on drag start and used in drag move\n  const containerPositionRef = React.useRef<Point>({ x: 0, y: 0 })\n  // on touch devices, we only start the drag gesture after pressing the item 200ms.\n  // this ref contains the timer id to be able to cancel it\n  const handleTouchStartTimerRef = React.useRef<number | undefined>(undefined)\n  // on non-touch device, we don't call onStart on mouse down but on the first mouse move\n  // we do this to let the user clicks on clickable element inside the container\n  // this means that the drag gesture actually starts on the fist move\n  const handleClickStartTimerMoveRef = React.useRef<number | null>(null)\n  // see https://twitter.com/ValentinHervieu/status/1324407814970920968\n  // we do this so that the parent doesn't have to use `useCallback()` for these callbacks\n  const callbacksRef = React.useRef({ onStart, onMove, onEnd })\n\n  // instead of relying on hacks to know if the device is a touch device or not,\n  // we track this using an onTouchStart listener on the document. (see https://codeburst.io/the-only-way-to-detect-touch-with-javascript-7791a3346685)\n  const [isTouchDevice, setTouchDevice] = React.useState(false)\n\n  React.useEffect(() => {\n    callbacksRef.current = { onStart, onMove, onEnd }\n  }, [onStart, onMove, onEnd])\n\n  const cancelTouchStart = () => {\n    if (handleTouchStartTimerRef.current) {\n      window.clearTimeout(handleTouchStartTimerRef.current)\n    }\n  }\n\n  const saveContainerPosition = React.useCallback(() => {\n    if (containerRef.current) {\n      const bounds = containerRef.current.getBoundingClientRect()\n      containerPositionRef.current = { x: bounds.left, y: bounds.top }\n    }\n  }, [containerRef])\n\n  const onDrag = React.useCallback((pointInWindow: Point) => {\n    const point = getPointInContainer(pointInWindow, containerPositionRef.current)\n    if (callbacksRef.current.onMove) {\n      callbacksRef.current.onMove({ pointInWindow, point })\n    }\n  }, [])\n\n  const onMouseMove = React.useCallback(\n    (e: MouseEvent) => {\n      onDrag(getMousePoint(e))\n      // otherwise, we do the normal move logic\n    },\n    [onDrag]\n  )\n\n  const moveStart = React.useCallback(\n      (e: PseudoMouseEvent) => {\n          const pointInWindow = getMousePoint(e)\n          const point = getPointInContainer(pointInWindow, containerPositionRef.current)\n          // if (Math.sqrt( Math.pow((oldPoint.x - point.x), 2) + Math.pow((oldPoint.y - point.y), 2)) > 50) {\n          //   return;\n          // }\n          if (callbacksRef.current.onStart) {\n            callbacksRef.current.onStart({ point, pointInWindow })\n          }\n      },\n      []\n  )\n\n  const onTouchMove = React.useCallback(\n    (e: TouchEvent) => {\n      if (e.cancelable) {\n        // Prevent the whole page from scrolling\n        e.preventDefault()\n        onDrag(getTouchPoint(e.touches[0]))\n      } else {\n        // if the event is not cancelable, it means the browser is currently scrolling\n        // which cannot be interrupted. Thus we cancel the drag gesture.\n        document.removeEventListener('touchmove', onTouchMove)\n        if (callbacksRef.current.onEnd) {\n          callbacksRef.current.onEnd()\n        }\n      }\n    },\n    [onDrag]\n  )\n\n  const onMouseUp = React.useCallback(() => {\n    if (handleClickStartTimerMoveRef.current) {\n      clearTimeout(handleClickStartTimerMoveRef.current)\n    }\n    document.removeEventListener('mousemove', onMouseMove)\n    document.removeEventListener('mouseup', onMouseUp)\n    if (callbacksRef.current.onEnd) {\n      callbacksRef.current.onEnd()\n    }\n  }, [onMouseMove])\n\n  const onTouchEnd = React.useCallback(() => {\n    document.removeEventListener('touchmove', onTouchMove)\n    document.removeEventListener('touchend', onTouchEnd)\n    enableContextMenu()\n    if (callbacksRef.current.onEnd) {\n      callbacksRef.current.onEnd()\n    }\n  }, [onTouchMove])\n\n  const onMouseDown = React.useCallback(\n    (e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n      if (e.button !== 0) {\n        // we don't want to handle clicks other than left ones\n        return\n      }\n\n      if (knobs?.length && !knobs.find((knob) => knob.contains(e.target as Node))) {\n        return\n      }\n\n      document.addEventListener('mousemove', onMouseMove)\n      document.addEventListener('mouseup', onMouseUp)\n\n      saveContainerPosition()\n\n      const x = e.clientX;\n      const y = e.clientY;\n      // mark the next move as being the first one\n      handleClickStartTimerMoveRef.current = window.setTimeout(\n          () => {\n            moveStart({\n              clientX: x,\n              clientY: y,\n            })\n          },\n          300\n      )\n    },\n    [onMouseMove, onMouseUp, saveContainerPosition, knobs]\n  )\n\n  const handleTouchStart = React.useCallback(\n    (point: Point, pointInWindow: Point) => {\n      document.addEventListener('touchmove', onTouchMove, { capture: false, passive: false })\n      document.addEventListener('touchend', onTouchEnd)\n      disableContextMenu()\n\n      if (callbacksRef.current.onStart) {\n        callbacksRef.current.onStart({ point, pointInWindow })\n      }\n    },\n    [onTouchEnd, onTouchMove]\n  )\n\n  const onTouchStart = React.useCallback(\n    (e: TouchEvent) => {\n      if (knobs?.length && !knobs.find((knob) => knob.contains(e.target as Node))) {\n        return\n      }\n\n      saveContainerPosition()\n\n      const pointInWindow = getTouchPoint(e.touches[0])\n      const point = getPointInContainer(pointInWindow, containerPositionRef.current)\n\n      // we wait 120ms to start the gesture to be sure that the user\n      // is not trying to scroll the page\n      handleTouchStartTimerRef.current = window.setTimeout(\n        () => handleTouchStart(point, pointInWindow),\n        120\n      )\n    },\n    [handleTouchStart, saveContainerPosition, knobs]\n  )\n\n  const detectTouchDevice = React.useCallback(() => {\n    setTouchDevice(true)\n    document.removeEventListener('touchstart', detectTouchDevice)\n  }, [])\n\n  // if the user is scrolling on mobile, we cancel the drag gesture\n  const touchScrollListener = React.useCallback(() => {\n    cancelTouchStart()\n  }, [])\n\n  React.useLayoutEffect(() => {\n    if (isTouchDevice) {\n      const container = containerRef.current\n\n      if (allowDrag) {\n        container?.addEventListener('touchstart', onTouchStart, { capture: true, passive: false })\n        // we are adding this touchmove listener to cancel drag if user is scrolling\n        // however, it's also important to have a touchmove listener always set\n        // with non-capture and non-passive option to prevent an issue on Safari\n        // with e.preventDefault (https://github.com/atlassian/react-beautiful-dnd/issues/1374)\n        document.addEventListener('touchmove', touchScrollListener, {\n          capture: false,\n          passive: false,\n        })\n        document.addEventListener('touchend', touchScrollListener, {\n          capture: false,\n          passive: false,\n        })\n      }\n\n      return () => {\n        container?.removeEventListener('touchstart', onTouchStart, { capture: true })\n        document.removeEventListener('touchmove', touchScrollListener, { capture: false })\n        document.removeEventListener('touchend', touchScrollListener, { capture: false })\n        document.removeEventListener('touchmove', onTouchMove)\n        document.removeEventListener('touchend', onTouchEnd)\n        enableContextMenu()\n        cancelTouchStart()\n      }\n    }\n    // if non-touch device\n    document.addEventListener('touchstart', detectTouchDevice)\n    return () => {\n      document.removeEventListener('touchstart', detectTouchDevice)\n      document.removeEventListener('mousemove', onMouseMove)\n      document.removeEventListener('mouseup', onMouseUp)\n    }\n  }, [\n    isTouchDevice,\n    allowDrag,\n    detectTouchDevice,\n    onMouseMove,\n    onTouchMove,\n    touchScrollListener,\n    onTouchEnd,\n    onMouseUp,\n    containerRef,\n    onTouchStart,\n  ])\n\n  // on touch devices, we cannot attach the onTouchStart directly via React:\n  // Touch handlers must be added with {passive: false} to be cancelable.\n  // https://developers.google.com/web/updates/2017/01/scrolling-intervention\n  return isTouchDevice ? {} : { onMouseDown }\n}\n","import arrayMove from 'array-move'\nimport React, { HTMLAttributes } from 'react'\n\nimport { findItemIndexAtPosition } from './helpers'\nimport { useDrag } from './hooks'\nimport { Point } from './types'\n\nconst DEFAULT_CONTAINER_TAG = 'div'\n\ntype Props<TTag extends keyof JSX.IntrinsicElements> = HTMLAttributes<TTag> & {\n  children: React.ReactNode\n  /** Determines whether drag functionality is enabled, defaults to true */\n  allowDrag?: boolean\n  /** Called when the user finishes a sorting gesture. */\n  onSortEnd: (oldIndex: number, newIndex: number) => void\n  /** Class applied to the item being dragged */\n  draggedItemClassName?: string\n  /** Determines which type of html tag will be used for a container element */\n  as?: TTag\n  /** Determines if an axis should be locked */\n  lockAxis?: 'x' | 'y'\n  /** Reference to the Custom Holder element */\n  customHolderRef?: React.RefObject<HTMLElement | null>\n}\n\n// this context is only used so that SortableItems can register/remove themselves\n// from the items list\ntype Context = {\n  registerItem: (item: HTMLElement) => void\n  removeItem: (item: HTMLElement) => void\n  registerKnob: (item: HTMLElement) => void\n  removeKnob: (item: HTMLElement) => void\n}\n\nconst SortableListContext = React.createContext<Context | undefined>(undefined)\nconst SortableList = <TTag extends keyof JSX.IntrinsicElements = typeof DEFAULT_CONTAINER_TAG>({\n  children,\n  allowDrag = true,\n  onSortEnd,\n  draggedItemClassName,\n  as,\n  lockAxis,\n  customHolderRef,\n  ...rest\n}: Props<TTag>) => {\n  // this array contains the elements than can be sorted (wrapped inside SortableItem)\n  const itemsRef = React.useRef<HTMLElement[]>([])\n  // this array contains the coordinates of each sortable element (only computed on dragStart and used in dragMove for perf reason)\n  const itemsRect = React.useRef<DOMRect[]>([])\n  // Hold all registered knobs\n  const knobs = React.useRef<HTMLElement[]>([])\n  // contains the container element\n  const containerRef = React.useRef<HTMLElement | null>(null)\n  // contains the target element (copy of the source element)\n  const targetRef = React.useRef<HTMLElement | null>(null)\n  // contains the index in the itemsRef array of the element being dragged\n  const sourceIndexRef = React.useRef<number | undefined>(undefined)\n  // contains the index in the itemsRef of the element to be exchanged with the source item\n  const lastTargetIndexRef = React.useRef<number | undefined>(undefined)\n  // contains the offset point where the initial drag occurred to be used when dragging the item\n  const offsetPointRef = React.useRef<Point>({ x: 0, y: 0 })\n\n  React.useEffect(() => {\n    const holder = customHolderRef?.current || document.body\n    return () => {\n      // cleanup the target element from the DOM when SortableList in unmounted\n      if (targetRef.current) {\n        holder.removeChild(targetRef.current)\n      }\n    }\n  }, [customHolderRef])\n\n  const updateTargetPosition = (position: Point) => {\n    if (targetRef.current && sourceIndexRef.current !== undefined) {\n      const offset = offsetPointRef.current\n      const sourceRect = itemsRect.current[sourceIndexRef.current]\n      const newX = lockAxis === 'y' ? sourceRect.left : position.x - offset.x\n      const newY = lockAxis === 'x' ? sourceRect.top : position.y - offset.y\n\n      // we use `translate3d` to force using the GPU if available\n      targetRef.current.style.transform = `translate3d(${newX}px, ${newY}px, 0px)`\n    }\n  }\n\n  const copyItem = React.useCallback(\n    (sourceIndex: number) => {\n      if (!containerRef.current) {\n        return\n      }\n\n      const source = itemsRef.current[sourceIndex]\n      const sourceRect = itemsRect.current[sourceIndex]\n\n      const copy = source.cloneNode(true) as HTMLElement\n\n      // added the \"dragged\" class name\n      if (draggedItemClassName) {\n        draggedItemClassName.split(' ').forEach((c) => copy.classList.add(c))\n      }\n\n      // we ensure the copy has the same size than the source element\n      copy.style.width = `${sourceRect.width}px`\n      copy.style.height = `${sourceRect.height}px`\n      // we place the target starting position to the top left of the window\n      // it will then be moved relatively using `transform: translate3d()`\n      copy.style.position = 'fixed'\n      copy.style.margin = '0'\n      copy.style.top = '0'\n      copy.style.left = '0'\n\n      const sourceCanvases = source.querySelectorAll('canvas')\n      copy.querySelectorAll('canvas').forEach((canvas, index) => {\n        canvas.getContext('2d')?.drawImage(sourceCanvases[index], 0, 0)\n      })\n\n      const holder = customHolderRef?.current || document.body\n      holder.appendChild(copy)\n\n      targetRef.current = copy\n    },\n    [customHolderRef, draggedItemClassName]\n  )\n\n  const listeners = useDrag({\n    allowDrag,\n    containerRef,\n    knobs: knobs.current,\n    onStart: ({ pointInWindow }) => {\n      if (!containerRef.current) {\n        return\n      }\n\n      itemsRect.current = itemsRef.current.map((item) => item.getBoundingClientRect())\n\n      const sourceIndex = findItemIndexAtPosition(pointInWindow, itemsRect.current)\n      // if we are not starting the drag gesture on a SortableItem, we exit early\n      if (sourceIndex === -1) {\n        return\n      }\n\n      // saving the index of the item being dragged\n      sourceIndexRef.current = sourceIndex\n\n      // the item being dragged is copied to the document body and will be used as the target\n      copyItem(sourceIndex)\n\n      // hide source during the drag gesture\n      const source = itemsRef.current[sourceIndex]\n      source.style.opacity = '0'\n      source.style.visibility = 'hidden'\n\n      // get the offset between the source item's window position relative to the point in window\n      const sourceRect = source.getBoundingClientRect()\n      offsetPointRef.current = {\n        x: pointInWindow.x - sourceRect.left,\n        y: pointInWindow.y - sourceRect.top,\n      }\n\n      updateTargetPosition(pointInWindow)\n\n      // Adds a nice little physical feedback\n      if (window.navigator.vibrate) {\n        window.navigator.vibrate(100)\n      }\n    },\n    onMove: ({ pointInWindow }) => {\n      updateTargetPosition(pointInWindow)\n\n      const sourceIndex = sourceIndexRef.current\n      // if there is no source, we exit early (happened when drag gesture was started outside a SortableItem)\n      if (sourceIndex === undefined || sourceIndexRef.current === undefined) {\n        return\n      }\n\n      const sourceRect = itemsRect.current[sourceIndexRef.current]\n      const targetPoint: Point = {\n        x: lockAxis === 'y' ? sourceRect.left : pointInWindow.x,\n        y: lockAxis === 'x' ? sourceRect.top : pointInWindow.y,\n      }\n\n      const targetIndex = findItemIndexAtPosition(targetPoint, itemsRect.current, {\n        fallbackToClosest: true,\n      })\n      // if not target detected, we don't need to update other items' position\n      if (targetIndex === -1) {\n        return\n      }\n      // we keep track of the last target index (to be passed to the onSortEnd callback)\n      lastTargetIndexRef.current = targetIndex\n\n      const isMovingRight = sourceIndex < targetIndex\n\n      // in this loop, we go over each sortable item and see if we need to update their position\n      for (let index = 0; index < itemsRef.current.length; index += 1) {\n        const currentItem = itemsRef.current[index]\n        const currentItemRect = itemsRect.current[index]\n        // if current index is between sourceIndex and targetIndex, we need to translate them\n        if (\n          (isMovingRight && index >= sourceIndex && index <= targetIndex) ||\n          (!isMovingRight && index >= targetIndex && index <= sourceIndex)\n        ) {\n          // we need to move the item to the previous or next item position\n          const nextItemRects = itemsRect.current[isMovingRight ? index - 1 : index + 1]\n          if (nextItemRects) {\n            const translateX = nextItemRects.left - currentItemRect.left\n            const translateY = nextItemRects.top - currentItemRect.top\n            // we use `translate3d` to force using the GPU if available\n            currentItem.style.transform = `translate3d(${translateX}px, ${translateY}px, 0px)`\n          }\n        }\n        // otherwise, the item should be at its original position\n        else {\n          currentItem.style.transform = 'translate3d(0,0,0)'\n        }\n        // we want the translation to be animated\n        currentItem.style.transitionDuration = '300ms'\n      }\n    },\n    onEnd: () => {\n      // we reset all items translations (the parent is expected to sort the items in the onSortEnd callback)\n      for (let index = 0; index < itemsRef.current.length; index += 1) {\n        const currentItem = itemsRef.current[index]\n        currentItem.style.transform = ''\n        currentItem.style.transitionDuration = ''\n      }\n\n      const sourceIndex = sourceIndexRef.current\n      if (sourceIndex !== undefined) {\n        // show the source item again\n        const source = itemsRef.current[sourceIndex]\n        if (source) {\n          source.style.opacity = '1'\n          source.style.visibility = ''\n        }\n\n        const targetIndex = lastTargetIndexRef.current\n        if (targetIndex !== undefined) {\n          if (sourceIndex !== targetIndex) {\n            // sort our internal items array\n            itemsRef.current = arrayMove(itemsRef.current, sourceIndex, targetIndex)\n            // let the parent know\n            onSortEnd(sourceIndex, targetIndex)\n          }\n        }\n      }\n      sourceIndexRef.current = undefined\n      lastTargetIndexRef.current = undefined\n\n      // cleanup the target element from the DOM\n      if (targetRef.current) {\n        const holder = customHolderRef?.current || document.body\n        holder.removeChild(targetRef.current)\n        targetRef.current = null\n      }\n    },\n  })\n\n  const registerItem = React.useCallback((item: HTMLElement) => {\n    itemsRef.current.push(item)\n  }, [])\n\n  const removeItem = React.useCallback((item: HTMLElement) => {\n    const index = itemsRef.current.indexOf(item)\n    if (index !== -1) {\n      itemsRef.current.splice(index, 1)\n    }\n  }, [])\n\n  const registerKnob = React.useCallback((item: HTMLElement) => {\n    knobs.current.push(item)\n  }, [])\n\n  const removeKnob = React.useCallback((item: HTMLElement) => {\n    const index = knobs.current.indexOf(item)\n\n    if (index !== -1) {\n      knobs.current.splice(index, 1)\n    }\n  }, [])\n\n  // we need to memoize the context to avoid re-rendering every children of the context provider\n  // when not needed\n  const context = React.useMemo(() => ({ registerItem, removeItem, registerKnob, removeKnob }), [\n    registerItem,\n    removeItem,\n    registerKnob,\n    removeKnob,\n  ])\n\n  return React.createElement(\n    as || DEFAULT_CONTAINER_TAG,\n    {\n      ...(allowDrag ? listeners : {}),\n      ...rest,\n      ref: containerRef,\n    },\n    <SortableListContext.Provider value={context}>{children}</SortableListContext.Provider>\n  )\n}\n\nexport default SortableList\n\ntype ItemProps = {\n  children: React.ReactElement\n}\n\n/**\n * SortableItem only adds a ref to its children so that we can register it to the main Sortable\n */\nexport const SortableItem = ({ children }: ItemProps) => {\n  const context = React.useContext(SortableListContext)\n  if (!context) {\n    throw new Error('SortableItem must be a child of SortableList')\n  }\n  const { registerItem, removeItem } = context\n  const elementRef = React.useRef<HTMLElement | null>(null)\n\n  React.useEffect(() => {\n    const currentItem = elementRef.current\n    if (currentItem) {\n      registerItem(currentItem)\n    }\n\n    return () => {\n      if (currentItem) {\n        removeItem(currentItem)\n      }\n    }\n    // if the children changes, we want to re-register the DOM node\n  }, [registerItem, removeItem, children])\n\n  return React.cloneElement(children, { ref: elementRef })\n}\n\nexport const SortableKnob = ({ children }: ItemProps) => {\n  const context = React.useContext(SortableListContext)\n\n  if (!context) {\n    throw new Error('SortableKnob must be a child of SortableList')\n  }\n\n  const { registerKnob, removeKnob } = context\n\n  const elementRef = React.useRef<HTMLElement | null>(null)\n\n  React.useEffect(() => {\n    const currentItem = elementRef.current\n\n    if (currentItem) {\n      registerKnob(currentItem)\n    }\n\n    return () => {\n      if (currentItem) {\n        removeKnob(currentItem)\n      }\n    }\n    // if the children changes, we want to re-register the DOM node\n  }, [registerKnob, removeKnob, children])\n\n  return React.cloneElement(children, { ref: elementRef })\n}\n"],"names":["findItemIndexAtPosition","_a","itemsRect","_b","x","y","_c","_d","fallbackToClosest","smallestDistance","smallestDistanceIndex","index","length","rect","left","right","top","bottom","itemCenterX","itemCenterY","distance","Math","sqrt","pow","getMousePoint","e","Number","clientX","clientY","getTouchPoint","touch","getPointInContainer","point","containerTopLeft","preventDefault","event","disableContextMenu","window","addEventListener","capture","passive","enableContextMenu","removeEventListener","useDrag","onStart","onMove","onEnd","allowDrag","containerRef","knobs","containerPositionRef","React","useRef","handleTouchStartTimerRef","undefined","handleClickStartTimerMoveRef","callbacksRef","useState","isTouchDevice","setTouchDevice","useEffect","current","cancelTouchStart","clearTimeout","saveContainerPosition","useCallback","bounds","getBoundingClientRect","onDrag","pointInWindow","onMouseMove","moveStart","onTouchMove","cancelable","touches","document","onMouseUp","onTouchEnd","onMouseDown","button","find","knob","contains","target","setTimeout","handleTouchStart","onTouchStart","detectTouchDevice","touchScrollListener","useLayoutEffect","container_1","DEFAULT_CONTAINER_TAG","SortableListContext","createContext","SortableList","children","onSortEnd","draggedItemClassName","as","lockAxis","customHolderRef","rest","itemsRef","targetRef","sourceIndexRef","lastTargetIndexRef","offsetPointRef","holder","body","removeChild","updateTargetPosition","position","offset","sourceRect","newX","newY","style","transform","copyItem","sourceIndex","source","copy","cloneNode","split","forEach","c","classList","add","width","height","margin","sourceCanvases","querySelectorAll","canvas","getContext","drawImage","appendChild","listeners","map","item","opacity","visibility","navigator","vibrate","targetPoint","targetIndex","isMovingRight","currentItem","currentItemRect","nextItemRects","translateX","translateY","transitionDuration","arrayMove","registerItem","push","removeItem","indexOf","splice","registerKnob","removeKnob","context","useMemo","createElement","ref","Provider","value","SortableItem","useContext","Error","elementRef","cloneElement","SortableKnob"],"mappings":"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"}